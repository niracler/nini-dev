# Tasks: Unify Style Consistency

> **ç¯å¢ƒ**ï¼š`pnpm dev` æŒç»­è¿è¡Œä¸­ï¼Œä¿®æ”¹ååˆ·æ–°é¡µé¢å³å¯éªŒè¯ã€‚
>
> **è¯´æ˜**ï¼š`ğŸ” CHECK` æ ‡è®°å¤„éœ€è¦äººå·¥ç¡®è®¤åå†ç»§ç»­ä¸‹ä¸€é˜¶æ®µã€‚

---

## Phase 1: æ ·å¼è§„èŒƒåŒ–ï¼ˆä½é£é™©ï¼‰

### 1.1 Token æ‰©å±•

- [x] 1.1.1 åœ¨ `tokens.css` æ·»åŠ ç¯ç®±ç›¸å…³ token
  - `--color-backdrop`
  - `--shadow-lightbox`
- [x] 1.1.2 åœ¨ `tokens.css` æ·»åŠ æŒ‰é’®æ‚¬åœ token
  - `--shadow-button-hover`
- [x] 1.1.3 æ·»åŠ å¯¹åº”çš„æ·±è‰²æ¨¡å¼å€¼

ğŸ” **CHECK 1.1**: âœ… DevTools ç¡®è®¤æ–° token åœ¨æµ…è‰²/æ·±è‰²æ¨¡å¼ç”Ÿæ•ˆ

---

### 1.2 GlobalImageLightbox ç¡¬ç¼–ç æ¶ˆé™¤

- [x] 1.2.1 æ›¿æ¢ backdrop èƒŒæ™¯è‰²ä¸º token
- [x] 1.2.2 æ›¿æ¢å›¾ç‰‡å®¹å™¨é˜´å½±ä¸º token
- [x] 1.2.3 ç§»é™¤å…³é—­æŒ‰é’® hover scaleï¼Œæ”¹ç”¨é¢œè‰²å˜åŒ–
- [x] 1.2.4 ç§»é™¤å¯¼èˆªæŒ‰é’® hover scaleï¼Œæ”¹ç”¨é¢œè‰²å˜åŒ–

ğŸ” **CHECK 1.2**: âœ… æ‰“å¼€åšå®¢æ–‡ç« å›¾ç‰‡ç¯ç®±ï¼Œæµ‹è¯• hover æ•ˆæœï¼Œæµ…è‰²/æ·±è‰²æ¨¡å¼

---

### 1.3 Channel é¡µé¢ç¡¬ç¼–ç æ¶ˆé™¤

- [x] 1.3.1 æ›¿æ¢æ‰€æœ‰ç¡¬ç¼–ç  border-radius ä¸º token
- [x] 1.3.2 å¤„ç†å†…é˜´å½±ï¼ˆtoken åŒ–æˆ–ç§»é™¤ï¼‰
- [x] 1.3.3 æ›¿æ¢ç¯ç®±é˜´å½±ä¸º tokenï¼ˆå¦‚é€‚ç”¨ï¼‰
- [x] 1.3.4 ç§»é™¤ç¯ç®±æŒ‰é’® hover scaleï¼ˆå¦‚é€‚ç”¨ï¼‰

ğŸ” **CHECK 1.3**: âœ… è®¿é—® `/channel`ï¼Œæ£€æŸ¥å¡ç‰‡åœ†è§’å’Œäº¤äº’æ•ˆæœ

---

### 1.4 MangaShots é¡µé¢ç¡¬ç¼–ç æ¶ˆé™¤

- [x] 1.4.1 æ›¿æ¢ç¯ç®± backdrop é¢œè‰²ä¸º token
- [x] 1.4.2 æ›¿æ¢æ‰€æœ‰ç¡¬ç¼–ç  border-radius ä¸º token
- [x] 1.4.3 æ›¿æ¢æ‰€æœ‰ç¡¬ç¼–ç  box-shadow ä¸º token
- [x] 1.4.4 æ›¿æ¢æŒ‰é’®èƒŒæ™¯ rgba ä¸º token æˆ– color-mix
- [x] 1.4.5 ç§»é™¤æ‰€æœ‰æŒ‰é’® hover scale/translateY æ•ˆæœ

ğŸ” **CHECK 1.4**: âœ… è®¿é—® `/mangashots`ï¼Œæµ‹è¯•ç¯ç®±æ‰“å¼€å’ŒæŒ‰é’® hover

---

### 1.5 Phase 1 éªŒè¯

- [x] 1.5.1 `pnpm build` æ— æ„å»ºé”™è¯¯
- [x] 1.5.2 æµ‹è¯•æ‰€æœ‰ä¿®æ”¹é¡µé¢ï¼ˆé¦–é¡µã€åšå®¢ã€channelã€mangashotsï¼‰
- [x] 1.5.3 æµ…è‰²/æ·±è‰²æ¨¡å¼åˆ‡æ¢æµ‹è¯•

ğŸ” **CHECK 1.5**: âœ… å…¨éƒ¨é€šè¿‡ï¼ŒPhase 1 å·²æäº¤

---

## Phase 2: ç»„ä»¶æŠ½è±¡ï¼ˆä¸­ç­‰å¤æ‚åº¦ï¼‰

### 2.1 æ»šåŠ¨é”å®šå·¥å…·

- [x] 2.1.1 åœ¨ `global.css` æ·»åŠ  `.scroll-locked` ç±»
- [x] 2.1.2 åˆ›å»º `src/utils/scrollLock.ts`
- [x] 2.1.3 è¿ç§» `Header.astro` ä½¿ç”¨æ–°å·¥å…·ï¼ˆä¿æŒåŸæœ‰ classList æ“ä½œï¼‰
- [x] 2.1.4 è¿ç§» `blog-interactive.ts` ä½¿ç”¨æ–°å·¥å…·ï¼ˆä¿æŒåŸæœ‰ classList æ“ä½œï¼‰
- [x] 2.1.5 è¿ç§»å…¶ä»–ä½¿ç”¨æ»šåŠ¨é”å®šçš„åœ°æ–¹

ğŸ” **CHECK 2.1**: âœ… æµ‹è¯•å¯¼èˆªæŠ½å±‰å’Œ TOC æŠ½å±‰çš„æ»šåŠ¨é”å®š

---

### 2.2 Drawer æŠ½å±‰ç»„ä»¶

> **å†³å®š**: è·³è¿‡æ­¤ä»»åŠ¡ã€‚åˆ†æå‘ç° Header.astro å’Œ blog-interactive.ts çš„æŠ½å±‰å®ç°å·®å¼‚è¾ƒå¤§
> ï¼ˆæ±‰å ¡åŠ¨ç”»ã€ç„¦ç‚¹ç®¡ç†ã€åª’ä½“æŸ¥è¯¢å¤„ç†ç­‰ï¼‰ï¼Œç»Ÿä¸€æˆæœ¬é«˜äºæ”¶ç›Šã€‚

- [x] 2.2.1 åˆ†æ Header.astro å’Œ blog-interactive.ts æŠ½å±‰å®ç°å·®å¼‚
- [x] ~~2.2.2 è®¾è®¡ç»Ÿä¸€çš„ Drawer ç»„ä»¶ API~~ (è·³è¿‡)
- [x] ~~2.2.3 åˆ›å»º `src/components/Drawer.astro` å’Œ `src/utils/drawer.ts`~~ (è·³è¿‡)
- [x] ~~2.2.4 è¿ç§» Header.astro å¯¼èˆªæŠ½å±‰~~ (è·³è¿‡)
- [x] ~~2.2.5 è¿ç§» TOC ç§»åŠ¨ç«¯æŠ½å±‰~~ (è·³è¿‡)

ğŸ” **CHECK 2.2**: âœ… è·³è¿‡ï¼Œä¿æŒç°æœ‰å®ç°

---

### 2.3 Lightbox ç¯ç®±ç»„ä»¶

- [x] 2.3.1 åˆ—å‡ºä¸‰å¥—ç¯ç®±åŠŸèƒ½å¯¹æ¯”è¡¨
- [x] 2.3.2 è®¾è®¡ç»Ÿä¸€çš„ Lightbox ç»„ä»¶ API
- [x] 2.3.3 åˆ›å»º `src/components/Lightbox.astro`
- [x] 2.3.4 è¿ç§»åšå®¢å›¾ç‰‡åŠŸèƒ½ï¼ˆPage.astro, BlogPost.astro, channelï¼‰
- [x] 2.3.5 ~~è¿ç§» Pandabox~~ (å‘ç°æœªä½¿ç”¨ï¼Œç›´æ¥åˆ é™¤)
- [x] 2.3.6 è¿ç§» mangashots ç¯ç®±
- [x] 2.3.7 åˆ é™¤æ—§ç¯ç®±ç»„ä»¶ï¼ˆGlobalImageLightbox.astro, Pandabox.astroï¼‰

ğŸ” **CHECK 2.3**: âœ… æµ‹è¯•æ‰€æœ‰ç¯ç®±åœºæ™¯ï¼ˆåšå®¢å›¾ç‰‡ã€channelã€mangashotsï¼‰

---

### 2.4 æ¶ˆé™¤ !important

- [x] 2.4.1 åˆ†æ mangashots `.filter-chip` æ ·å¼å†²çªæ¥æºï¼ˆæ— å®é™…å†²çªï¼Œä¸ºé˜²å¾¡æ€§å†™æ³•ï¼‰
- [x] 2.4.2 ç®€åŒ–é€‰æ‹©å™¨ä¸º `.filter-chip`
- [x] 2.4.3 ç§»é™¤ mangashots æ‰€æœ‰ 27 å¤„ `!important`
- [x] 2.4.4 éªŒè¯ç­›é€‰å™¨æ ·å¼æ­£å¸¸

> **æ³¨**: global.css ä¸­ 26 å¤„ `!important` ç”¨äº Shiki/Mermaid ç¬¬ä¸‰æ–¹åº“è¦†ç›–ï¼Œä¿ç•™ã€‚

ğŸ” **CHECK 2.4**: âœ… mangashots ç­›é€‰å™¨æ˜¾ç¤ºå’Œäº¤äº’æ­£å¸¸

---

### 2.5 Phase 2 éªŒè¯

- [x] 2.5.1 æœç´¢ç¡®è®¤æ—  `document.body.style.overflow` ç›´æ¥æ“ä½œ
- [x] 2.5.2 æœç´¢ç¡®è®¤æ— éç¬¬ä¸‰æ–¹åº“çš„ `!important`
- [x] 2.5.3 `pnpm build` æ— æ„å»ºé”™è¯¯

ğŸ” **CHECK 2.5**: âœ… å…¨éƒ¨é€šè¿‡ï¼ŒPhase 2 å·²å®Œæˆ

---

## Phase 3: JS æ ·å¼å‰¥ç¦»ï¼ˆå¯é€‰ï¼‰

> **å†³å®š**: æ ‡è®°ä¸ºå¯é€‰ï¼Œæš‚ä¸æ‰§è¡Œã€‚å½“å‰å®ç°å·²æ»¡è¶³éœ€æ±‚ã€‚

### 3.1 postPreview.ts æ ·å¼å¤–ç§»

- [ ] 3.1.1 åœ¨ CSS å®šä¹‰é¢„è§ˆå¡ç‰‡çš„æ˜¾ç¤º/éšè—çŠ¶æ€ç±»
- [ ] 3.1.2 ä¿®æ”¹ JS åªæ“ä½œ classList
- [ ] 3.1.3 æµ‹è¯•æ–‡ç« åˆ—è¡¨ hover é¢„è§ˆ

ğŸ” **CHECK 3.1**: (è·³è¿‡)

---

### 3.2 blog-interactive.ts æ ·å¼å¤–ç§»

- [ ] 3.2.1 å°† embed-wrapper å†…è”æ ·å¼ç§»è‡³ CSS
- [ ] 3.2.2 è¯„ä¼° aside åŠ¨æ€å®šä½æ˜¯å¦éœ€ä¿ç•™ JS

ğŸ” **CHECK 3.2**: (è·³è¿‡)

---

## æ–‡æ¡£æ›´æ–°

- [x] 4.1 æ›´æ–° design-primitives.mdï¼Œç§»é™¤å·²å®Œæˆçš„"å¾…é‡æ„"é¡¹
- [x] 4.2 æ·»åŠ æ–° token å’Œç»„ä»¶è¯´æ˜
- [x] 4.3 è¿è¡Œ `openspec validate unify-style-consistency --strict`
- [x] 4.4 è¿è¡Œ `pnpm build` ç¡®è®¤

ğŸ” **CHECK 4**: âœ… æ–‡æ¡£å·²æ›´æ–°ï¼Œæ‰€æœ‰ä»»åŠ¡å®Œæˆ

---

## ä¾èµ–å…³ç³»

```
Phase 1 (ç‹¬ç«‹ï¼Œä½é£é™©) âœ…
    â†“
Phase 2.1 (æ»šåŠ¨é”å®š) âœ…
    â†“
Phase 2.2 (Drawer) âœ… [è·³è¿‡]  â†â†’  Phase 2.3 (Lightbox) âœ…
    â†“
Phase 2.4 (!important) âœ…
    â†“
Phase 3 (å¯é€‰) [è·³è¿‡]
    â†“
æ–‡æ¡£æ›´æ–° âœ…
```
