# 页 10：Function Call（🔴 重点）

## 页面内容摘要

```text
# Function Call
🔴 重点
2023.6 · 从「回答」到「执行」

左栏：5 步流程
1. 开发者定义可用函数
2. 用户提问
3. 【关键】模型输出结构化 JSON — 决定调用什么，但不执行
4. 系统执行函数，返回结果
5. 模型整合结果，生成回复

右栏：Mermaid 时序图 + 核心提示
🔑 没有 Function Call，就没有 Agent
```

## 6 问分析

### 1. 如何讲

- **时长**：~4 分钟
- **节奏**：先讲 5 步流程，重点强调第 3 步「决定但不执行」，再看时序图，最后现场演示
- **过渡语**：
  - 开场：「前面都是 LLM 本身的能力——能理解、能回答。但 GPT-4 还带来了另一个关键能力：Function Call。从这里开始，AI 能『做事』了」
  - 结束：「有了 Function Call，AI 从『回答问题』进化到『执行任务』。但如何保证它知道『该查什么』？下一页讲 RAG」
- **核心记忆点**：**模型只『决定』，不『执行』——这是安全边界，也是 Agent 的基础**

### 2. 为何要懂

- **重要程度**：🔴 必须懂
- **价值**：这是理解 Agent 的关键。不懂 Function Call，后面的 Agent、MCP、Subagent 都会一头雾水
- **痛点**：很多人以为 AI「能做事」是魔法，其实是一套结构化的协议

### 3. 演示策略

- **需要演示**：是（强烈推荐）
- **演示指令**：「帮我分析一下当前仓库的 markdown 文件有多少文字？」
- **演示工具**：Claude Code
- **演示要点**：
  1. Claude 先调用 Glob 找到所有 .md 文件
  2. 再调用 Read 或 Bash(wc) 统计每个文件
  3. 最后整合结果，给出汇总
- **亮点**：观众能清楚看到「决策 → 执行 → 整合」的完整循环
- **时长**：约 30 秒

### 4. 可能问题

**同事视角：**

| 问题 | 准备的回答 |
| --------------------------------- | ------------------------------------------------------------------------------------------------------------- |
| Function Call 和 API 有什么区别？ | API 是程序员写代码调用；Function Call 是让 AI 自己决定调用什么 API。你告诉 AI「有这些工具」，它自己选择用哪个 |
| 为什么模型不直接执行？ | 安全考虑。如果模型能直接执行 `rm -rf /`，后果不堪设想。决策和执行分离，程序可以审核和拦截危险操作 |
| 这和 Copilot 补全有什么区别？ | Copilot 只能预测代码，Function Call 能调用真实 API（查天气、操作文件、发邮件）。一个是「写」，一个是「做」 |
| 调用失败怎么办？ | 返回错误信息给模型，模型可以换个工具或换个参数重试。好的 Agent 会有重试和降级策略 |
| JSON 输出格式是固定的吗？ | 是的，OpenAI/Anthropic 都定义了标准格式。开发者用 JSON Schema 描述函数签名，模型按格式输出 |

**老板视角：**

| 问题 | 准备的回答 |
| ---------------------- | ------------------------------------------------------------------------------------------------------------- |
| 这能接入我们的系统吗？ | 可以。只需定义 JSON Schema 描述你的接口，模型就能调用。Claude 和 GPT 都支持，主流框架（LangChain 等）都有封装 |
| 安全吗？会不会做错事？ | 设计上是安全的——模型只输出「我想调用 X」，真正执行由你的代码控制。可以加权限检查、人工确认等 |
| 能做什么具体业务？ | 查库存、查订单、查设备状态、生成报表、调用内部 API。任何能写成 API 的操作，理论上都能让 AI 调用 |
| 和 RPA 有什么区别？ | RPA 是「录制回放」，写死流程；Function Call 是「智能决策」，根据需求动态选择工具。更灵活，能处理变化 |

### 5. 取舍逻辑

| 没讲的内容 | 取舍理由 |
| ------------------------- | -------------------------------------- |
| JSON Schema 具体语法 | 📚 太技术细节，开发时查文档即可 |
| Streaming 响应处理 | ⏱️ 实现细节，扫盲不需要 |
| Parallel Function Calling | 📚 进阶功能，基础概念先过 |
| 各厂商实现差异 | ⏱️ OpenAI/Anthropic 大同小异，不必展开 |

**如果被问到怎么答**：「技术实现上各家略有差异，但核心思想一样——模型输出 JSON 决策，程序负责执行。具体语法开发时查文档就好。」

### 6. 观点/事实区分

| 内容 | 类型 | 来源 |
| ----------------------------------- | -------- | --------------------- |
| 2023.6 发布 | 事实 | OpenAI 官方文档 |
| 「没有 Function Call 就没有 Agent」 | 共识观点 | 行业普遍认同 |
| 决策与执行分离 | 事实 | API 设计规范 |
| 5 步流程描述 | 事实 | OpenAI/Anthropic 文档 |

## 演示备忘

**正式演示**：

```
帮我分析一下当前仓库的 markdown 文件有多少文字？
```

**备用演示**（如果时间更紧）：

```
这个目录下有多少个 TypeScript 文件？
```

**演示时口述**：

> 「注意看，我只是问了一个问题，但 Claude 自己决定了要先找文件、再统计、最后汇总。这就是 Function Call——模型决定『调用什么工具』，程序负责『真正执行』。」
